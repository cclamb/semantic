#!/usr/bin/env ruby
# require 'rdf'
# require 'rdf/ntriples'

# include RDF

require 'sparql/client'

Remote_Data = 'http://dbpedia.org/sparql'
Local_Data = 'file:/etc/movie-data.nt'

sparql = SPARQL::Client.new Local_Data

Short_Query = 'ASK WHERE { ?s ?p ?o }'

Query=<<END_QUERY
PREFIX fb:<http://rdf.freebase.com/ns/>
SELECT ?who ?film
WHERE{
    ?film fb:film.film.directed_by ?who .
    ?film fb:film.film.starring ?who .
}
END_QUERY

result = sparql.query Short_Query

puts result.inspect